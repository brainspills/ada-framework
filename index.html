<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Ada Framework by brainspills</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Ada Framework</h1>
      <h2 class="project-tagline">Node JS + Restify REST API Framework</h2>
      <a href="https://github.com/brainspills/ada-framework" class="btn">View on GitHub</a>
      <a href="https://github.com/brainspills/ada-framework/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/brainspills/ada-framework/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="ada-framework-documentation" class="anchor" href="#ada-framework-documentation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Ada Framework Documentation</h1>

<p><a href="https://travis-ci.org/brainspills/ada-framework"><img src="https://travis-ci.org/brainspills/ada-framework.svg?branch=master" alt="Build Status"></a></p>

<h4>
<a id="ada-is-an-api-development-framework-written-in-nodejs-and-restify-aimed-to-help-developers-build-a-standard-rest-api" class="anchor" href="#ada-is-an-api-development-framework-written-in-nodejs-and-restify-aimed-to-help-developers-build-a-standard-rest-api" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Ada is an API development framework written in NodeJS and Restify aimed to help developers build a standard REST API.</strong>
</h4>

<p>Ada framework aims to minimize coding by providing flexible functionality through configuration and definition. A REST API is basically a provider of resources (abstracted as models) through client requests (determined through routes). The framework heavily depends on model and route definitions to complete a client request.</p>

<p>For any request, the API returns any of the 3 basic types of responses: <code>collection</code>, <code>document</code>, and <code>controller</code>. <code>GET</code> requests are routed to either a collection or a document. <code>POST</code> and <code>PUT</code> requests which may require some additional logic are routed to controllers. The logic maybe defined within these controllers.</p>

<blockquote>
<p><em>The API has an auto generated reference through its base URL (<code>/</code>) and can be interacted with from an API browser at <code>/browser</code>.</em></p>
</blockquote>

<p><strong>Requirements</strong></p>

<ul>
<li><a href="https://nodejs.org/">NodeJS</a></li>
<li><a href="https://www.mongodb.org/">MongoDB</a></li>
</ul>

<p><strong>Installation</strong></p>

<p><strong><code>npm update</code></strong> to install framework dependencies. To start serving, issue a <code>node index.js</code> or <code>nodejs index.js</code> command. On startup, the application will prompt you to configure the server.</p>

<h2>
<a id="1-models" class="anchor" href="#1-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Models</h2>

<p>Model definitions are located inside the <code>models</code> directory and each model should extend the core model class (<code>./core/model.js</code>).</p>

<h3>
<a id="11-defining-models" class="anchor" href="#11-defining-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>1.1 Defining Models</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Model <span class="pl-k">=</span> extend(<span class="pl-s"><span class="pl-pds">'</span>model<span class="pl-pds">'</span></span>);

<span class="pl-k">function</span> <span class="pl-k">&lt;</span>Model Name<span class="pl-k">&gt;</span>() {

  <span class="pl-k">var</span> self <span class="pl-k">=</span> <span class="pl-v">this</span>;
  Model.<span class="pl-c1">call</span>(<span class="pl-v">this</span>);

  self.collectionName <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Required. Collection name in MongoDB&gt;<span class="pl-pds">"</span></span>;

  self.collectionURI <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Required. URL segment to attach in HAL links for collections&gt;<span class="pl-pds">"</span></span>;
  self.documentURI <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Required. URL segment to attach in HAL links for documents&gt;<span class="pl-pds">"</span></span>;

  self.schema <span class="pl-k">=</span> [
    {
      <span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Required. Field name in the collection&gt;<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>reference<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Optional. If the field is a reference to another collection, define the referenced collection here using its model name.&gt;<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>constraints<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-k">&lt;</span><span class="pl-c1">Object</span>, Optional. Data validation definition. Refer to validate.js documentation.<span class="pl-k">&gt;</span>
      },
      <span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>label<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Optional. Label of the field&gt;<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>desc<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Optional. Description of the field&gt;<span class="pl-pds">"</span></span>
      }
    }
    ...
  ];

  <span class="pl-c">/* Optional */</span>
  self.identifier <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Optional. Key name to be used as identifier if the model is using an identifier other than 'id'. A unique index will be automatically created for this key&gt;<span class="pl-pds">"</span></span>;

  <span class="pl-c">/* Optional */</span>
  self.embed <span class="pl-k">=</span> {
    <span class="pl-s"><span class="pl-pds">"</span>&lt;Embed Name&gt;<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
      <span class="pl-s"><span class="pl-pds">"</span>model<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String or Array, Required. Model name of the embeddable collection&gt;<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Required. Local key referencing foreign collection ID&gt;<span class="pl-pds">"</span></span>
    }
    ...
  };

  <span class="pl-c">/* Optional */</span>
  self.indeces <span class="pl-k">=</span> {
    <span class="pl-k">&lt;</span><span class="pl-c1">Object</span>, Optional. Indexing information <span class="pl-k">of</span> the collection. Refer to MongoDB documentation.<span class="pl-k">&gt;</span>
  };

}

<span class="pl-k">&lt;</span>Model Name<span class="pl-k">&gt;</span>.<span class="pl-c1">prototype</span> <span class="pl-k">=</span> <span class="pl-c1">Object</span>.create(Model.<span class="pl-c1">prototype</span>);
<span class="pl-k">&lt;</span>Model Name<span class="pl-k">&gt;</span>prototype.<span class="pl-c1">constructor</span> <span class="pl-k">=</span> Model;

<span class="pl-c1">module</span>.exports <span class="pl-k">=</span> <span class="pl-k">&lt;</span>Model Name<span class="pl-k">&gt;</span>;</pre></div>

<h3>
<a id="12-loading-models" class="anchor" href="#12-loading-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>1.2 Loading Models</h3>

<p>The <code>loadModel(model)</code> helper will return an instance of the model. The model could be either of the following forms:</p>

<ul>
<li>A string <code>&lt;model_name&gt;</code> which will be load <code>./http/models/&lt;model_name&gt;.js</code>
</li>
<li>An array <code>['&lt;package_name&gt;', '&lt;model_name&gt;']</code> which will load <code>./packages/&lt;package_name&gt;/models/&lt;model_name&gt;.js</code>
</li>
</ul>

<h3>
<a id="13-model-methods" class="anchor" href="#13-model-methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>1.3 Model Methods</h3>

<table>
<thead>
<tr>
<th>Method Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>all(page, callback)</code></strong></td>
<td>List all documents in a page from a collection</td>
</tr>
<tr>
<td><strong><code>create(document, callback)</code></strong></td>
<td>Create a single document in the collection</td>
</tr>
<tr>
<td><strong><code>delete(id, callback)</code></strong></td>
<td>Remove a single document from the collection by its identifier</td>
</tr>
<tr>
<td><strong><code>find(page, query, callback)</code></strong></td>
<td>Query a collection in a page based on a query</td>
</tr>
<tr>
<td><strong><code>findOne(query, callback)</code></strong></td>
<td>Query a collection based on a query, expect one document</td>
</tr>
<tr>
<td><strong><code>id(id, callback)</code></strong></td>
<td>Retrieve a document from the collection by its identifier</td>
</tr>
<tr>
<td><strong><code>update(id, document, callback)</code></strong></td>
<td>Update a single document by its identifier</td>
</tr>
</tbody>
</table>

<hr>

<h2>
<a id="2-routing" class="anchor" href="#2-routing" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Routing</h2>

<p>Route definitions are located inside the <code>http/routes</code> directory.</p>

<h3>
<a id="21-defining-routes" class="anchor" href="#21-defining-routes" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.1 Defining Routes</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">module</span>.exports <span class="pl-k">=</span> [
  {
    <span class="pl-s"><span class="pl-pds">"</span>route<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Required. Route URL. Refer to Restify documentation&gt;<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>method<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Required. HTTP method to use: <span class="pl-pds">"</span></span>get<span class="pl-s"><span class="pl-pds">"</span>, <span class="pl-pds">"</span></span>post<span class="pl-s"><span class="pl-pds">"</span>, <span class="pl-pds">"</span></span>put<span class="pl-s"><span class="pl-pds">"</span>, <span class="pl-pds">"</span></span><span class="pl-k">delete</span><span class="pl-s"><span class="pl-pds">"</span>&gt;<span class="pl-pds">"</span></span>,

    <span class="pl-s"><span class="pl-pds">"</span>response<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
      <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Required. Type of response expected: <span class="pl-pds">"</span></span>collection<span class="pl-s"><span class="pl-pds">"</span>, <span class="pl-pds">"</span></span><span class="pl-c1">document</span><span class="pl-s"><span class="pl-pds">"</span>, <span class="pl-pds">"</span></span>controller<span class="pl-s"><span class="pl-pds">"</span>&gt;<span class="pl-pds">"</span></span>
    },

    <span class="pl-c">/* Optional */</span>
    <span class="pl-s"><span class="pl-pds">"</span>request<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
      <span class="pl-s"><span class="pl-pds">"</span>insert<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
         <span class="pl-s"><span class="pl-pds">"</span>&lt;Request parameter name&gt;<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Required. Type of value to be assigned: <span class="pl-pds">"</span></span>auth.user.<span class="pl-c1">id</span><span class="pl-s"><span class="pl-pds">"</span>&gt;<span class="pl-pds">"</span></span>
         ...
     } 
    },

    <span class="pl-s"><span class="pl-pds">"</span>binding<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
      <span class="pl-s"><span class="pl-pds">"</span>model<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String or Array, Optional. Model name of which this route is attached. Required when response type is <span class="pl-pds">"</span></span>collection<span class="pl-s"><span class="pl-pds">"</span> or <span class="pl-pds">"</span></span><span class="pl-c1">document</span><span class="pl-s"><span class="pl-pds">"</span>. Also required when <span class="pl-pds">"</span></span>binding.keys<span class="pl-s"><span class="pl-pds">"</span> is present&gt;<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>controller<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String or Array, Optional. Controller name of where the request is to be routed. Required when response type is <span class="pl-pds">"</span></span>controller<span class="pl-s"><span class="pl-pds">"</span>&gt;<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Optional. Action name of where the request is to be routed. Required when response type is controller. No need to define action if this is set to <span class="pl-pds">"</span></span>create<span class="pl-s"><span class="pl-pds">"</span> or <span class="pl-pds">"</span></span>update<span class="pl-s"><span class="pl-pds">"</span>&gt;<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>embed<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Optional. Embed a related collection to the model retrieved. The reference is defined by the <span class="pl-pds">"</span></span>embed<span class="pl-s"><span class="pl-pds">"</span> property of the model definition&gt;<span class="pl-pds">"</span></span>
      <span class="pl-s"><span class="pl-pds">"</span>keys<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
        <span class="pl-k">&lt;</span><span class="pl-c1">Array</span> <span class="pl-k">of</span> Strings, Optional. List <span class="pl-k">of</span> keys that the route is expecting<span class="pl-k">&gt;</span>
      ]
    },

    <span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
      <span class="pl-s"><span class="pl-pds">"</span>desc<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;String, Optional. Description of the route. Will not be included in reference and browser if not set&gt;<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>live<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-k">&lt;</span><span class="pl-c1">Boolean</span>, Required. Activate or deactivate a route<span class="pl-k">&gt;</span>,
      <span class="pl-s"><span class="pl-pds">"</span>noauth<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-k">&lt;</span><span class="pl-c1">Boolean</span>, Required. When set to <span class="pl-c1">false</span>, the route will not <span class="pl-c1">require</span> the Authorization credentials. Defaults to <span class="pl-c1">true</span><span class="pl-k">&gt;</span>,
      <span class="pl-s"><span class="pl-pds">"</span>scope<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
        <span class="pl-k">&lt;</span><span class="pl-c1">Array</span> <span class="pl-k">of</span> Strings, Optional. List <span class="pl-k">of</span> scope names that can access <span class="pl-v">this</span> route. Scope will be determined <span class="pl-k">from</span> the authorization credential<span class="pl-k">&gt;</span>
      ]
    }
  }
  ...
];</pre></div>

<h3>
<a id="22-collection-routing" class="anchor" href="#22-collection-routing" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.2 Collection Routing</h3>

<p>To enable collection routing, set the following values in the route definition (along with the other properties). The route will automatically retrieve documents (a collection) within the bound model.</p>

<div class="highlight highlight-source-js"><pre>{
  <span class="pl-s"><span class="pl-pds">'</span>method<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>get<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">'</span>response<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>collection<span class="pl-pds">'</span></span>
  },      
  <span class="pl-s"><span class="pl-pds">'</span>binding<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">'</span>model<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;model name&gt;<span class="pl-pds">'</span></span>
  }
}</pre></div>

<h4>
<a id="221-pagination" class="anchor" href="#221-pagination" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.2.1. Pagination</h4>

<p>Setting a route's response type to <code>collection</code> will automatically enable it to be paged. To browse through pages within a collection, pass in a <code>page</code> query parameter in the request.</p>

<pre><code>/&lt;route_name&gt;?page=&lt;page_number&gt;
</code></pre>

<h4>
<a id="222-filters" class="anchor" href="#222-filters" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.2.2. Filters</h4>

<p>Filters are automatically enabled for a route with the <code>collection</code> response type. To filter results from a collection, pass in a key-value pair of the keys you want to filter through the query parameter of the request.</p>

<pre><code>/&lt;route_name&gt;?&lt;key1_in_collection&gt;=&lt;value&gt;&amp;&lt;key2_in_collection&gt;=&lt;value&gt;
</code></pre>

<p>The route can also be combined with the pager to browse through filtered collections.</p>

<pre><code>/&lt;route_name&gt;?page=&lt;page_number&gt;&amp;&lt;key1_in_collection&gt;=&lt;value&gt;&amp;&lt;key2_in_collection&gt;=&lt;value&gt;
</code></pre>

<h3>
<a id="23-document-routing" class="anchor" href="#23-document-routing" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.3 Document Routing</h3>

<p>To enable document routing, set the following values in the route definition (along with the other properties). The route will automatically retrieve a document based on the provided ID (<code>:id</code>). The <code>:id</code> is a required segment of the route - it will resolve to the key set as <code>identifier</code> in the model if it is set.</p>

<div class="highlight highlight-source-js"><pre>{
  <span class="pl-s"><span class="pl-pds">'</span>route<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>/&lt;route_name&gt;/:id<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">'</span>method<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>get<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">'</span>response<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>document<span class="pl-pds">'</span></span>
  },      
  <span class="pl-s"><span class="pl-pds">'</span>binding<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">'</span>model<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;model name&gt;<span class="pl-pds">'</span></span>
  }
}</pre></div>

<h4>
<a id="231-embedding-related-collections" class="anchor" href="#231-embedding-related-collections" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.3.1. Embedding Related Collections</h4>

<p>To retrieve a document with an embedded related collection (one to many relation), set the following values in the route definition (along with the other properties). The value passed to the <code>binding.embed</code> key should match one of the embed keys defined in the parent model - defined in this route through <code>binding.model</code>.</p>

<div class="highlight highlight-source-js"><pre>{    
  <span class="pl-s"><span class="pl-pds">'</span>binding<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">'</span>model<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;model name&gt;<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>embed<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;embed name&gt;<span class="pl-pds">'</span></span>
  }
}</pre></div>

<p>Since a collection is also returned through the route, pagination and filters are automatically enabled as well.</p>

<pre><code>/&lt;route_name&gt;/&lt;document_id&gt;/&lt;embed_name&gt;?page=&lt;page_number&gt;&amp;&lt;key1_in_collection&gt;=&lt;value&gt;&amp;&lt;key2_in_collection&gt;=&lt;value&gt;
</code></pre>

<h3>
<a id="24-controller-routing" class="anchor" href="#24-controller-routing" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.4 Controller Routing</h3>

<p>To route a request to a controller, set the following values in the route definition (along with the other properties). The value in the <code>binding.controller</code> property will have <code>./http/controllers</code> as its base path.</p>

<div class="highlight highlight-source-js"><pre>{
  <span class="pl-s"><span class="pl-pds">'</span>response<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>controller<span class="pl-pds">'</span></span>,
  },
  <span class="pl-s"><span class="pl-pds">'</span>binding<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
     <span class="pl-s"><span class="pl-pds">'</span>controller<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;path/to/controller&gt;<span class="pl-pds">'</span></span>,
     <span class="pl-s"><span class="pl-pds">'</span>action<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;action name&gt;<span class="pl-pds">'</span></span>
  }
}</pre></div>

<h4>
<a id="defining-controllers" class="anchor" href="#defining-controllers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Defining Controllers</h4>

<p>Controller definitions are located inside the <code>http/controllers</code> directory and each controller should extend the core controller class (<code>./core/controller.js</code>).</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Controller <span class="pl-k">=</span> extend(<span class="pl-s"><span class="pl-pds">'</span>controller<span class="pl-pds">'</span></span>);

<span class="pl-k">function</span> <span class="pl-k">&lt;</span>Controller Name<span class="pl-k">&gt;</span>(request, response) {

    <span class="pl-k">var</span> self <span class="pl-k">=</span> <span class="pl-v">this</span>;

    Controller.<span class="pl-c1">call</span>(<span class="pl-v">this</span>, request, response); 

    self.<span class="pl-k">&lt;</span>action name<span class="pl-k">&gt;</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
      <span class="pl-c">/** Action definition **/</span>
    };

    ...

}

<span class="pl-k">&lt;</span>Controller Name<span class="pl-k">&gt;</span>.<span class="pl-c1">prototype</span> <span class="pl-k">=</span> <span class="pl-c1">Object</span>.create(Controller.<span class="pl-c1">prototype</span>);
<span class="pl-k">&lt;</span>Controller Name<span class="pl-k">&gt;</span>.<span class="pl-c1">prototype</span>.<span class="pl-c1">constructor</span> <span class="pl-k">=</span> Controller;

<span class="pl-c1">module</span>.exports <span class="pl-k">=</span> <span class="pl-k">&lt;</span>Controller Name<span class="pl-k">&gt;</span>;</pre></div>

<h4>
<a id="241-create-action" class="anchor" href="#241-create-action" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.4.1 Create Action</h4>

<p>For routes that insert a document in a collection, a reserved action name of <code>create</code> is available for the controller routing. This will create a document in the bound model after it has been validated using the model's schema constraints. Set the following values in the route definition (along with the other properties) to enable the controller/create action.</p>

<div class="highlight highlight-source-js"><pre>{
  <span class="pl-s"><span class="pl-pds">'</span>method<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>post<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>binding<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
      <span class="pl-s"><span class="pl-pds">'</span>action<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>create<span class="pl-pds">'</span></span>,
      <span class="pl-s"><span class="pl-pds">'</span>model<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;model name&gt;<span class="pl-pds">'</span></span> 
    }
  }
}</pre></div>

<h4>
<a id="242-update-action" class="anchor" href="#242-update-action" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.4.2 Update Action</h4>

<p>For routes that edit a document in a collection, a reserved action name of <code>update</code> is available for the controller routing. This will update a document from the bound model after it has been validated using the model's schema constraints based on the provided ID (<code>:id</code>). Set the following values in the route definition (along with the other properties) to enable the controller/update action. The <code>:id</code> is a required segment of the route - it will resolve to the key set as <code>identifier</code> in the model if it is set.</p>

<div class="highlight highlight-source-js"><pre>{
  <span class="pl-s"><span class="pl-pds">'</span>route<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>/&lt;route_name&gt;/:id<span class="pl-pds">'</span></span>, 
  <span class="pl-s"><span class="pl-pds">'</span>method<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>put<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">'</span>binding<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">'</span>action<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>update<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>model<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;model name&gt;<span class="pl-pds">'</span></span> 
  }
}</pre></div>

<h4>
<a id="243-delete-action" class="anchor" href="#243-delete-action" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.4.3 Delete Action</h4>

<p>For routes that remove a document from a collection, a reserved action name of <code>delete</code> is available for the controller routing. This will delete a document from the bound model based on the provided ID (<code>:id</code>) and will cascade to related collections as well. Set the following values in the route definition (along with the other properties) to enable the controller/delete action.The <code>:id</code> is a required segment of the route - it will resolve to the key set as <code>identifier</code> in the model if it is set.</p>

<div class="highlight highlight-source-js"><pre>{
  <span class="pl-s"><span class="pl-pds">'</span>route<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>/&lt;route_name&gt;/:id<span class="pl-pds">'</span></span>, 
  <span class="pl-s"><span class="pl-pds">'</span>method<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>delete<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">'</span>binding<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">'</span>action<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>delete<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>model<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;model name&gt;<span class="pl-pds">'</span></span> 
  }
}</pre></div>

<hr>

<h2>
<a id="3-authentication" class="anchor" href="#3-authentication" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Authentication</h2>

<p>An authentication package is enabled by default. The source files are located in <code>./packages/auth</code>.</p>

<hr>

<h2>
<a id="4-hooks" class="anchor" href="#4-hooks" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. Hooks</h2>

<p>Execution hooks are pieces of logic that are executed in predefined areas of the application. </p>

<h3>
<a id="41-defining-hooks" class="anchor" href="#41-defining-hooks" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.1. Defining Hooks</h3>

<p>Hooks are defined in <code>http/hooks.js</code>.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">module</span>.exports <span class="pl-k">=</span> [
  {
    <span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;hook type&gt;<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span><span class="pl-en">callback</span><span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-k">function</span>(&lt;<span class="pl-smi">callback</span> <span class="pl-smi">arguments</span>&gt;) {
      <span class="pl-c">/** Hook definition **/</span> 
    }
  }
  ...
];</pre></div>

<h3>
<a id="42-hook-types" class="anchor" href="#42-hook-types" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.2. Hook Types</h3>

<table>
<thead>
<tr>
<th>Hook Type</th>
<th>Callback Arguments</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>preroute</code></strong></td>
<td><code>route, request, response</code></td>
<td>Happens just before the request is routed. Return <code>false</code> from the callback to cancel the routing.</td>
</tr>
</tbody>
</table>

<hr>

<h2>
<a id="5-packaging" class="anchor" href="#5-packaging" aria-hidden="true"><span class="octicon octicon-link"></span></a>5. Packaging</h2>

<p>The framework can be modularized by grouping related routes, controllers, models, hooks, services, and configs together in a package. Follow the following directory structure to create a package:</p>

<pre><code>./
 |
 +-- packages/
      |
      +-- &lt;package_name&gt;
           |
           |-- config/
           |    |
           |    |-- &lt;config_file&gt;.js
           |    +-- ...
           |
           |-- http/
           |    |
           |    |-- controllers/
           |    |    | 
           |    |    |-- &lt;controller_file&gt;.js
           |    |    +-- ...
           |    | 
           |    |-- routes/
           |    |    |
           |    |    |-- &lt;route_file&gt;.js
           |    |    +-- ...
           |    |
           |    +-- hooks.js
           |
           |-- models/
           |    |
           |    |-- &lt;model_file&gt;.js
           |    +-- ...
           |
           +-- services/
                |
                |-- &lt;service_file&gt;.js
                +-- ...
</code></pre>

<p>To enable the package, include it the <code>packages</code> array in <code>./config/app.js</code></p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> packages <span class="pl-k">=</span> [
  <span class="pl-s"><span class="pl-pds">'</span>&lt;package_name&gt;<span class="pl-pds">'</span></span>,
  ...
]; </pre></div>

<hr>

<h2>
<a id="6-generators" class="anchor" href="#6-generators" aria-hidden="true"><span class="octicon octicon-link"></span></a>6. Generators</h2>

<h3>
<a id="61-auto-generating-models" class="anchor" href="#61-auto-generating-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.1 Auto Generating Models</h3>

<pre><code>npm run-script generate:model -- &lt;model name&gt; &lt;comma separated list of keys&gt; &lt;optional: package name&gt;
OR
node tools/generate model &lt;model name&gt; &lt;comma separated list of keys&gt; &lt;optional: package name&gt;
</code></pre>

<p>This tool will automatically generate a basic model definition based from the provided name and list of keys.</p>

<h3>
<a id="62-auto-generating-resources" class="anchor" href="#62-auto-generating-resources" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.2 Auto Generating Resources</h3>

<pre><code>npm run-script generate:resource -- &lt;resource name&gt; &lt;comma separated list of keys&gt; &lt;optional: package name&gt;
OR
node tools/generate resource &lt;resource name&gt; &lt;comma separated list of keys&gt; &lt;optional: package name&gt;
</code></pre>

<p>This tool will automatically generate a basic model definition based from the provided name and list of keys along with the following associated routes:</p>

<table>
<thead>
<tr>
<th>Route</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>GET /&lt;resources&gt;</code></strong></td>
<td>to retrieve the collection</td>
</tr>
<tr>
<td><strong><code>GET /&lt;resource&gt;/:id</code></strong></td>
<td>to retrieve a document by its identifier</td>
</tr>
<tr>
<td><strong><code>POST /&lt;resource&gt;</code></strong></td>
<td>to create a document</td>
</tr>
<tr>
<td><strong><code>PUT /&lt;resource&gt;/:id</code></strong></td>
<td>to update a document by its identifier</td>
</tr>
<tr>
<td><strong><code>DELETE /&lt;resource&gt;/:id</code></strong></td>
<td>to delete a document by its identifier</td>
</tr>
</tbody>
</table>

<h3>
<a id="63-auto-generating-controllers" class="anchor" href="#63-auto-generating-controllers" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.3 Auto Generating Controllers</h3>

<pre><code>npm run-script generate:controller -- &lt;controller name&gt; &lt;comma separated list of actions&gt; &lt;optional: package name&gt;
OR
node tools/generate controller &lt;controller name&gt; &lt;comma separated list of actions&gt; &lt;optional: package name&gt;
</code></pre>

<p>This tool will automatically generate a controller definition based from the provided name and list of actions.</p>

<hr>

<h2>
<a id="7-helpers" class="anchor" href="#7-helpers" aria-hidden="true"><span class="octicon octicon-link"></span></a>7. Helpers</h2>

<table>
<thead>
<tr>
<th>Helper</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>getConfig(namespace, key)</code></strong></td>
<td>Returns a configuration value</td>
</tr>
<tr>
<td><strong><code>getUTCStamp()</code></strong></td>
<td>Returns the current timestamp in UTC</td>
</tr>
<tr>
<td><strong><code>hash(string)</code></strong></td>
<td>Returns a hashed form of a string. A key for hashing is set from <code>.env</code> using the <code>APP_KEY</code> key</td>
</tr>
<tr>
<td><strong><code>isEmpty(object)</code></strong></td>
<td>Tests the "emptiness" of a value. Returns <code>true</code> if the value is any of the following: <code>undefined</code>, <code>null</code>, <code>false</code>, <code>0</code>, zero length string or array, objects with no properties</td>
</tr>
<tr>
<td><strong><code>loadModel(model)</code></strong></td>
<td>Returns a new instance of a model</td>
</tr>
<tr>
<td><strong><code>toHttpDateTime(timestamp)</code></strong></td>
<td>Returns a date and time string from a timestamp in RFC 2616 format</td>
</tr>
</tbody>
</table>

<hr>

<h2>
<a id="8-under-development--known-issues" class="anchor" href="#8-under-development--known-issues" aria-hidden="true"><span class="octicon octicon-link"></span></a>8. Under Development / Known Issues</h2>

<p>A list of things to do can be collected using the <code>todo</code> tool.</p>

<pre><code>npm run-script todo
OR 
node tools/todo
</code></pre>

<p>Annotate the file line with a <code>//TODO: &lt;description&gt;</code> for it to display in the results.</p>

<hr>

<h2>
<a id="9-improvements" class="anchor" href="#9-improvements" aria-hidden="true"><span class="octicon octicon-link"></span></a>9. Improvements</h2>

<p>A list of stuff that may be needed to improve the framework</p>

<ul>
<li>Database abstraction</li>
<li>Model, route, and controller modifier tool</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/brainspills/ada-framework">Ada Framework</a> is maintained by <a href="https://github.com/brainspills">brainspills</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
