{"name":"Ada Framework","tagline":"Node JS + Restify REST API Framework","body":"# Ada Framework Documentation\r\n\r\n[![Build Status](https://travis-ci.org/brainspills/ada-framework.svg?branch=master)](https://travis-ci.org/brainspills/ada-framework)\r\n\r\n**Ada is an API development framework written in NodeJS and Restify aimed to help developers build a standard REST API.**\r\n\r\nAda framework aims to minimize coding by providing flexible functionality through configuration and definition. A REST API is basically a provider of resources (abstracted as models) through client requests (determined through routes). The framework heavily depends on model and route definitions to complete a client request.\r\n\r\n\r\nFor any request, the API returns any of the 3 basic types of responses: `collection`, `document`, and `controller`. `GET` requests are routed to either a collection or a document. `POST` and `PUT` requests which may require some additional logic are routed to controllers. The logic maybe defined within these controllers.\r\n\r\n\r\n_The API has an auto generated reference through its base URL (`/`) and can be interacted with from an API browser at `/browser`._\r\n\r\n**Requirements**\r\n* NodeJS\r\n* MongoDB\r\n\r\n**Installation**\r\n\r\n**`npm update`** to install framework dependencies. To start serving, issue a `node index.js` or `nodejs index.js` command. On startup, the application will prompt you to configure the server.\r\n\r\n## 1. Models\r\n\r\nModel definitions are located inside the `models` directory and each model should extend the core model class (`./core/model.js`).\r\n\r\n### 1.1 Defining Models\r\n\r\n    var Model = extend('model');\r\n\r\n    function <Model Name>() {\r\n\r\n      var self = this;\r\n      Model.call(this);\r\n\r\n      self.collectionName = \"<String, Required. Collection name in MongoDB>\";\r\n\r\n      self.collectionURI = \"<String, Required. URL segment to attach in HAL links for collections>\";\r\n      self.documentURI = \"<String, Required. URL segment to attach in HAL links for documents>\";\r\n\r\n      self.schema = [\r\n        {\r\n          \"key\": \"<String, Required. Field name in the collection>\",\r\n          \"reference\": \"<String, Optional. If the field is a reference to another collection, define the referenced collection here using its model name.>\",\r\n          \"constraints\": {\r\n            <Object, Optional. Data validation definition. Refer to validate.js documentation.>\r\n          },\r\n          \"meta\": {\r\n            \"label\": \"<String, Optional. Label of the field>\",\r\n            \"desc\": \"<String, Optional. Description of the field>\"\r\n          }\r\n        }\r\n        ...\r\n      ];\r\n\r\n      /* Optional */\r\n      self.embed = {\r\n        \"<Embed Name>\": {\r\n          \"model\": \"<String, Required. Model name of the embeddable collection>\",\r\n          \"key\": \"<String, Required. Local key referencing foreign collection ID>\"\r\n        }\r\n        ...\r\n      };\r\n\r\n      /* Optional */\r\n      self.indeces = {\r\n        <Object, Optional. Indexing information of the collection. Refer to MongoDB documentation.>\r\n      };\r\n\r\n    }\r\n\r\n    <Model Name>.prototype = Object.create(Model.prototype);\r\n    <Model Name>prototype.constructor = Model;\r\n\r\n    module.exports = <Model Name>;\r\n\r\n### 1.2 Loading Models\r\n\r\nThe `loadModel()` helper will return an instance of the model.\r\n\r\n### 1.3 Model Methods\r\n\r\n* **`all(page, callback)`** - List all documents in a page from a collection\r\n* **`create(document, callback)`** - Create a single document in the collection\r\n* **`delete(id, callback)`** - Remove a single document from the collection\r\n* **`find(page, query, callback)`** - Query a collection in a page based on a query\r\n* **`findOne(query, callback)`** - Query a collection based on a query, expect one document\r\n* **`id(id, callback)`** - Retrieve a document from the collection by its id\r\n* **`update(document, callback)`** - Update a single document by its id\r\n\r\n***\r\n\r\n## 2. Routing\r\n\r\nRoute definitions are located inside the `http/routes` directory.\r\n\r\n### 2.1 Defining Routes\r\n\r\n    module.exports = [\r\n      {\r\n        \"route\": \"<String, Required. Route URL. Refer to Restify documentation>\",\r\n        \"method\": \"<String, Required. HTTP method to use: \"get\", \"post\", \"put\", \"delete\">\",\r\n\r\n        \"response\": {\r\n          \"type\": \"<String, Required. Type of response expected: \"collection\", \"document\", \"controller\">\"\r\n        },\r\n\r\n        /* Optional */\r\n        \"request\": {\r\n          \"insert\": {\r\n             \"<Request parameter name>\": \"<String, Required. Type of value to be assigned: \"auth.user.id\">\"\r\n             ...\r\n         } \r\n        },\r\n\t\t\r\n        \"binding\": {\r\n          \"model\": \"<String, Optional. Model name of which this route is attached. Required when response type is \"collection\" or \"document\". Also required when \"binding.keys\" is present>\",\r\n          \"controller\": \"<String, Optional. Controller name of where the request is to be routed. Required when response type is \"controller\">\",\r\n          \"action\": \"<String, Optional. Action name of where the request is to be routed. Required when response type is controller. No need to define action if this is set to \"create\" or \"update\">\",\r\n          \"embed\": \"<String, Optional. Embed a related collection to the model retrieved. The reference is defined by the \"embed\" property of the model definition>\"\r\n          \"keys\": [\r\n            <Array of Strings, Optional. List of keys that the route is expecting>\r\n          ]\r\n        },\r\n\r\n        \"meta\": {\r\n          \"desc\": \"<String, Optional. Description of the route. Will not be included in reference and browser if not set>\",\r\n          \"live\": <Boolean, Required. Activate or deactivate a route>,\r\n          \"noauth\": <Boolean, Required. When set to false, the route will not require the Authorization credentials. Defaults to true>,\r\n          \"scope\": [\r\n            <Array of Strings, Optional. List of scope names that can access this route. Scope will be determined from the authorization credential>\r\n          ]\r\n        }\r\n      }\r\n      ...\r\n    ];\r\n\r\n### 2.2 Collection Routing\r\n\r\nTo enable collection routing, set the following values in the route definition (along with the other properties). The route will automatically retrieve documents (a collection) within the bound model.\r\n\r\n    {\r\n      'method': 'get',\r\n      'response': {\r\n        'type': 'collection'\r\n      },      \r\n      'binding': {\r\n        'model': '<model name>'\r\n      }\r\n    }\r\n\r\n#### 2.2.1. Pagination\r\n\r\nSetting a route's response type to `collection` will automatically enable it to be paged. To browse through pages within a collection, pass in a `page` query parameter in the request.\r\n\r\n    /<route_name>?page=<page_number>\r\n\r\n\r\n#### 2.2.2. Filters\r\n\r\nFilters are automatically enabled for a route with the `collection` response type. To filter results from a collection, pass in a key-value pair of the keys you want to filter through the query parameter of the request.\r\n\r\n    /<route_name>?<key1_in_collection>=<value>&<key2_in_collection>=<value>\r\n\r\nThe route can also be combined with the pager to browse through filtered collections.\r\n\r\n    /<route_name>?page=<page_number>&<key1_in_collection>=<value>&<key2_in_collection>=<value>\r\n\r\n### 2.3 Document Routing\r\n\r\nTo enable document routing, set the following values in the route definition (along with the other properties). The route will automatically retrieve a document based on the provided ID (`:id`). The `:id` is a required segment of the route.\r\n\r\n    {\r\n      'route': '/<route_name>/:id',\r\n      'method': 'get',\r\n      'response': {\r\n        'type': 'document'\r\n      },      \r\n      'binding': {\r\n        'model': '<model name>'\r\n      }\r\n    }\r\n\r\n#### 2.3.1. Embedding Related Collections\r\n\r\nTo retrieve a document with an embedded related collection (one to many relation), set the following values in the route definition (along with the other properties). The value passed to the `binding.embed` key should match one of the embed keys defined in the parent model - defined in this route through `binding.model`.\r\n\r\n    {    \r\n      'binding': {\r\n        'model': '<model name>',\r\n        'embed': '<embed name>\r\n      }\r\n    }\r\n\r\nSince a collection is also returned through the route, pagination and filters are automatically enabled as well.\r\n\r\n    /<route_name>/<document_id>/<embed_name>?page=<page_number>&<key1_in_collection>=<value>&<key2_in_collection>=<value>\r\n\r\n### 2.4 Controller Routing\r\n\r\nTo route a request to a controller, set the following values in the route definition (along with the other properties). The value in the `binding.controller` property will have `./http/controllers` as its base path.\r\n\r\n    {\r\n      'response': {\r\n        'type': 'controller',\r\n      },\r\n      'binding': {\r\n         'controller': '<path/to/controller>',\r\n         'action': '<action name>'\r\n      }\r\n    }\r\n\r\n#### Defining Controllers\r\n\r\nController definitions are located inside the `http/controllers` directory and each controller should extend the core controller class (`./core/controller.js`).\r\n\r\n    var Controller = extend('controller');\r\n\r\n    function <Controller Name>(request, response) {\r\n\r\n        var self = this;\r\n\r\n        Controller.call(this, request, response); \r\n\r\n        self.<action name> = function() {\r\n          /** Action definition **/\r\n        };\r\n\r\n        ...\r\n\r\n    }\r\n\r\n    <Controller Name>.prototype = Object.create(Controller.prototype);\r\n    <Controller Name>.prototype.constructor = Controller;\r\n\r\n    module.exports = <Controller Name>;\r\n\r\n#### 2.4.1 Create Action\r\n\r\nFor routes that insert a document in a collection, a reserved action name of `create` is available for the controller routing. This will create a document in the bound model after it has been validated using the model's schema constraints. Set the following values in the route definition (along with the other properties) to enable the controller/create action.\r\n\r\n    {\r\n      'method': 'post',\r\n        'binding': {\r\n          'action': 'create',\r\n          'model': '<model name>' \r\n        }\r\n      }\r\n    }\r\n\r\n#### 2.4.2 Update Action\r\n\r\nFor routes that edit a document in a collection, a reserved action name of `update` is available for the controller routing. This will update a document from the bound model after it has been validated using the model's schema constraints based on the provided ID (`:id`). Set the following values in the route definition (along with the other properties) to enable the controller/update action.The `:id` is a required segment of the route.\r\n\r\n    {\r\n      'route': '/<route_name>/:id', \r\n      'method': 'put',\r\n      'binding': {\r\n        'action': 'update',\r\n        'model': '<model name>' \r\n      }\r\n    }\r\n\r\n#### 2.4.3 Delete Action\r\n\r\nFor routes that remove a document from a collection, a reserved action name of `delete` is available for the controller routing. This will delete a document from the bound model based on the provided ID (`:id`) and will cascade to related collections as well. Set the following values in the route definition (along with the other properties) to enable the controller/delete action.The `:id` is a required segment of the route.\r\n\r\n    {\r\n      'route': '/<route_name>/:id', \r\n      'method': 'delete',\r\n      'binding': {\r\n        'action': 'delete',\r\n        'model': '<model name>' \r\n      }\r\n    }\r\n\r\n***\r\n\r\n## 3. Authentication\r\n\r\n***\r\n\r\n## 4. Hooks\r\n\r\n***\r\n\r\n## 5. Packaging\r\n\r\n***\r\n\r\n## 6. Generators\r\n\r\n### 6.1 Auto Generating Models\r\n\r\n    npm run-script generate:model -- <model name> <comma separated list of keys> <optional: package name>\r\n    OR\r\n    node tools/generate model <model name> <comma separated list of keys> <optional: package name>\r\n\r\nThis tool will automatically generate a basic model definition based from the provided name and list of keys.\r\n\r\n### 6.2 Auto Generating Resources\r\n\r\n    npm run-script generate:resource -- <resource name> <comma separated list of keys> <optional: package name>\r\n    OR\r\n    node tools/generate resource <resource name> <comma separated list of keys> <optional: package name>\r\n\r\nThis tool will automatically generate a basic model definition based from the provided name and list of keys along with the following associated routes:\r\n\r\n* **`GET /<resources>`** - to retrieve the collection\r\n* **`GET /<resource>/:id`** - to retrieve a document\r\n* **`POST /<resource>`** - to create a document\r\n* **`PUT /<resource>/:id`** - to update a document\r\n* **`DELETE /<resource>/:id`** - to delete a document\r\n\r\n### 6.3 Auto Generating Controllers\r\n\r\n    npm run-script generate:controller -- <controller name> <comma separated list of actions> <optional: package name>\r\n    OR\r\n    node tools/generate controller <controller name> <comma separated list of actions> <optional: package name>\r\n\r\nThis tool will automatically generate a controller definition based from the provided name and list of actions.\r\n\r\n***\r\n\r\n## 7. Helpers\r\n\r\n* **`getConfig(namespace, key)`** - Returns a configuration value\r\n* **`hash(string)`** - Returns a hashed form of a string. A key for hashing is set from `.env` using the `SERVER_KEY` key\r\n* **`isEmpty(object)`** - Tests the \"emptiness\" of a value. Returns `true` if the value is any of the following: `undefined`, `null`, `false`, `0`, zero length string or array, objects with no properties \r\n* **`loadModel(model)`** - Returns a new instance of a model\r\n\r\n*** \r\n\r\n## 8. Under Development / Known Issues\r\n\r\n* Standardization of error responses for unique validation fails\r\n* Ensure data types for document create/update based on schema definition\r\n* Validation for presence of related collection on document create/update\r\n* Validation for document update\r\n* Cascade of delete\r\n* Implement scopes\r\n\r\nA list of things to do can be collected using the `todo` tool.\r\n\r\n    npm run-script todo\r\n    OR \r\n    node tools/todo\r\n\r\nAnnotate the file line with a `//TODO: <description>` for it to display in the results.\r\n\r\n*** \r\n\r\n## 9. Improvements\r\n\r\nA list of stuff that may be needed to improve the framework\r\n\r\n* Database abstraction\r\n* Package \"namespacing\"\r\n* Model, route, and controller modifier tool\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}